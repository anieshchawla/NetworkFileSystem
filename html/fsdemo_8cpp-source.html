<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>COP4610 Project 3: lab/pr3/fsdemo.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>lab/pr3/fsdemo.cpp</h1><pre class="fragment"><div>00001 
00008 <span class="preprocessor">#include "<a class="code" href="includes_8h.html">includes.h</a>"</span>
00009 <span class="preprocessor">#include "<a class="code" href="_r_a_m_disk_8h.html">RAMDisk.h</a>"</span>
00010 <span class="preprocessor">#include "<a class="code" href="_v_disk_8h.html">VDisk.h</a>"</span>
00011 <span class="preprocessor">#include "<a class="code" href="_volume_8h.html">Volume.h</a>"</span>
00012 <span class="preprocessor">#include "<a class="code" href="_f_s_8h.html">FS.h</a>"</span>
00013 
00014 <span class="keywordtype">void</span> demo_dir(<a class="code" href="class_f_s.html">FS</a>&amp; fs, <a class="code" href="class_volume.html">Volume</a>&amp; V);
00015 <span class="keywordtype">void</span> demo_file(<a class="code" href="class_f_s.html">FS</a>&amp; fs, <a class="code" href="class_volume.html">Volume</a>&amp; V);
00016 
00017 <span class="keywordtype">int</span> main()
00018 {
00019   <a class="code" href="class_f_s.html">FS</a> fs;
00020 
00021   <a class="code" href="class_r_a_m_disk.html">RAMDisk</a> RAM;
00022 
00023   RAM.<a class="code" href="class_r_a_m_disk.html#a4">format</a>(100);
00024 
00025   <a class="code" href="class_volume.html">Volume</a> A(<span class="stringliteral">"A"</span>, RAM);
00026 
00027   demo_dir(fs, A);
00028 
00029   demo_file(fs, A);
00030 
00031   banner(<span class="stringliteral">"Trying VDisk"</span>);
00032 
00033   <a class="code" href="class_v_disk.html">VDisk</a> VDSK;
00034 
00035   <span class="keywordflow">if</span> (VDSK.<a class="code" href="class_v_disk.html#a4">format</a>(50) != <a class="code" href="_disk_8h.html#a1">DISK_ERROR</a>)
00036   {
00037     <a class="code" href="class_volume.html">Volume</a> B(<span class="stringliteral">"B"</span>, VDSK);
00038 
00039     demo_dir(fs, B);
00040 
00041     demo_file(fs, B);
00042   }
00043 
00044   <span class="keywordflow">return</span> 0;
00045 }
00046 
00047 <span class="keywordtype">void</span> demo_dir(<a class="code" href="class_f_s.html">FS</a>&amp; fs, <a class="code" href="class_volume.html">Volume</a>&amp; V)
00048 {
00049   banner(<span class="stringliteral">"Creating directory foo"</span>);
00050 
00051   fs.<a class="code" href="class_f_s.html#a9">mkdir</a>(V, <span class="stringliteral">"/"</span>, <span class="stringliteral">"foo"</span>);
00052 
00053   banner(<span class="stringliteral">"Creating directory bar within foo"</span>);
00054 
00055   fs.<a class="code" href="class_f_s.html#a9">mkdir</a>(V, <span class="stringliteral">"/foo"</span>, <span class="stringliteral">"bar"</span>);
00056 
00057   banner(<span class="stringliteral">"Listing /"</span>);
00058 
00059   fs.<a class="code" href="class_f_s.html#a7">ls</a>(V, <span class="stringliteral">"/"</span>);
00060 
00061   banner(<span class="stringliteral">"Listing /foo"</span>);
00062 
00063   fs.<a class="code" href="class_f_s.html#a7">ls</a>(V, <span class="stringliteral">"/foo"</span>);
00064 
00065   banner(<span class="stringliteral">"Removing directory bar from foo"</span>);
00066 
00067   fs.<a class="code" href="class_f_s.html#a10">rmdir</a>(V, <span class="stringliteral">"/foo"</span>, <span class="stringliteral">"bar"</span>);
00068 
00069   banner(<span class="stringliteral">"Listing /foo"</span>);
00070 
00071   fs.<a class="code" href="class_f_s.html#a7">ls</a>(V, <span class="stringliteral">"/foo"</span>);
00072 }
00073 
00074 <span class="keywordtype">void</span> demo_file(<a class="code" href="class_f_s.html">FS</a>&amp; fs, <a class="code" href="class_volume.html">Volume</a>&amp; V)
00075 {
00076   banner(<span class="stringliteral">"Opening abc"</span>);
00077 
00078   <span class="keywordtype">int</span> fd = fs.<a class="code" href="class_f_s.html#a2">open</a>(V, <span class="stringliteral">"/"</span>, <span class="stringliteral">"abc"</span>);
00079 
00080   <span class="keywordflow">if</span> (fd != <a class="code" href="_disk_8h.html#a1">DISK_ERROR</a>)
00081   {
00082     <span class="keywordtype">char</span> buf[15];
00083 
00084     buf[14] = <span class="charliteral">'\0'</span>;
00085 
00086     banner(<span class="stringliteral">"Storing text in abc"</span>);
00087 
00088     fs.<a class="code" href="class_f_s.html#a5">write</a>(fd, <span class="stringliteral">"Hello   World!"</span>, 14);
00089     
00090     fs.<a class="code" href="class_f_s.html#a6">seek</a>(fd, 0);
00091 
00092     fs.<a class="code" href="class_f_s.html#a4">read</a>(fd, buf, 14);
00093 
00094     printf(<span class="stringliteral">"text: %s\n"</span>, buf);
00095 
00096     fs.<a class="code" href="class_f_s.html#a6">seek</a>(fd, 0);
00097 
00098     fs.<a class="code" href="class_f_s.html#a5">write</a>(fd, <span class="stringliteral">"Goodbye"</span>, 7);
00099 
00100     fs.<a class="code" href="class_f_s.html#a6">seek</a>(fd, 0);
00101 
00102     fs.<a class="code" href="class_f_s.html#a4">read</a>(fd, buf, 14);
00103 
00104     printf(<span class="stringliteral">"text: %s\n"</span>, buf);
00105 
00106     banner(<span class="stringliteral">"Closing abc"</span>);
00107 
00108     fs.<a class="code" href="class_f_s.html#a3">close</a>(fd);
00109 
00110     banner(<span class="stringliteral">"Listing /"</span>);
00111 
00112     fs.<a class="code" href="class_f_s.html#a7">ls</a>(V, <span class="stringliteral">"/"</span>);
00113 
00114     banner(<span class="stringliteral">"Removing abc"</span>);
00115 
00116     fs.<a class="code" href="class_f_s.html#a8">rm</a>(V, <span class="stringliteral">"/"</span>, <span class="stringliteral">"abc"</span>);
00117 
00118     banner(<span class="stringliteral">"Listing /"</span>);
00119 
00120     fs.<a class="code" href="class_f_s.html#a7">ls</a>(V, <span class="stringliteral">"/"</span>);
00121   }
00122 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Fri Mar 24 14:26:14 2006 for COP4610 Project 3 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.8 </small></address>
</body>
</html>
